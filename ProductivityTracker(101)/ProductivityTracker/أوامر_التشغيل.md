# أوامر التشغيل - نظام إدارة المهندسين الاستشاريين

## البيئة المحلية (Ubuntu/Linux)

### 1. التشغيل السريع (مُوصى به)
```bash
./start-local-enhanced.sh
```

### 2. إصلاح المشاكل (عند وجود أخطاء)
```bash
./check-and-fix-user.sh
```

### 3. إعادة إنشاء قاعدة البيانات من الصفر
```bash
./fix-local-database.sh
```

---

## البيئة السحابية (Replit)

### التشغيل العادي
```bash
npm run dev
```

---

## أوامر قاعدة البيانات

### الاتصال بقاعدة البيانات المحلية
```bash
PGPASSWORD=password psql -h localhost -U postgres -d consulting_engineers
```

### تشغيل PostgreSQL (إذا توقف)
```bash
sudo systemctl start postgresql
sudo systemctl enable postgresql
```

### التحقق من حالة PostgreSQL
```bash
sudo systemctl status postgresql
```

---

## أوامر التطوير

### تشغيل Frontend فقط
```bash
npm run dev:client
```

### تشغيل Backend فقط
```bash
npm run dev:server
```

### بناء المشروع للإنتاج
```bash
npm run build
```

### تشغيل الإنتاج
```bash
npm run start
```

---

## أوامر الصيانة

### تحديث مخطط قاعدة البيانات
```bash
npm run db:push
```

### اختبار الاتصال بقاعدة البيانات
```bash
./debug-database.sh
```

### تنظيف وإعادة تثبيت التبعيات
```bash
rm -rf node_modules package-lock.json
npm install
```

---

## معلومات الوصول

### الرابط المحلي
```
http://localhost:5000
```

### بيانات تسجيل الدخول الافتراضية
```
المدير العام:
Username: admin
Password: admin123

مدير الموارد البشرية:
Username: hr_manager  
Password: hr123

المدير العام:
Username: general_manager
Password: gm123
```

---

## استكشاف الأخطاء

### إذا كانت المنافذ مشغولة
```bash
sudo lsof -i :5000
sudo kill -9 [PID]
```

### إذا فشل الاتصال بقاعدة البيانات
```bash
sudo systemctl restart postgresql
./fix-local-database.sh
```

### إذا ظهرت أخطاء في الأعمدة
```bash
./debug-database.sh
```

### مسح جميع البيانات وإعادة البدء
```bash
sudo -u postgres psql -c "DROP DATABASE consulting_engineers;"
./fix-local-database.sh
```

---

## المتغيرات البيئية المطلوبة

### ملف .env.local
```env
LOCAL_DEVELOPMENT=true
NODE_ENV=development
DATABASE_URL=postgresql://postgres:password@localhost:5432/consulting_engineers
PORT=5000
PGHOST=localhost
PGPORT=5432
PGUSER=postgres
PGPASSWORD=password
PGDATABASE=consulting_engineers
```

---

## الإعداد الأولي (مرة واحدة فقط)

### 1. تثبيت Node.js و PostgreSQL
```bash
sudo apt update
sudo apt install nodejs npm postgresql postgresql-contrib
```

### 2. إعداد PostgreSQL
```bash
sudo systemctl start postgresql
sudo -u postgres createuser --interactive postgres
sudo -u postgres psql -c "ALTER USER postgres PASSWORD 'password';"
```

### 3. تثبيت التبعيات
```bash
npm install
```

### 4. إنشاء قاعدة البيانات
```bash
./fix-local-database.sh
```

### 5. تشغيل النظام
```bash
./start-local-enhanced.sh
```

---

## ملاحظات مهمة

- تأكد من تشغيل PostgreSQL قبل بدء التطبيق
- استخدم `./start-local-enhanced.sh` للتشغيل العادي
- استخدم `./check-and-fix-user.sh` عند وجود مشاكل
- الرابط المحلي: http://localhost:5000
- جميع الميزات تعمل بشكل كامل في البيئة المحلية